<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../styles/default-theme.html">
<dom-module id="koa-card">
  <template>
    <style>
      :host {
        display: block;
        margin-bottom: 10px;
      }

      :host [hidden] {
        display: none !important;
      }

      .card-block {
        padding-top: 0!important;
      }

      :host .card-block:not([class="koa-card"]) {
        padding-bottom: 0!important;
      }
      :host .card-block.koa-card {
        padding: 1.25rem!important;
      }

      :host .inverse-color,
      :host .inverse-color h4,
      :host .inverse-color h5,
      :host .inverse-color h6,
      :host .inverse-color ::content .card-block blockquote footer{
        color: #fff!important;
      }

      :host .card-img-top,
      :host .card-img-bottom {
        width: inherit!important;
      }
    </style>
    <div class$="card {{alignment}} {{inverse}} {{color}} {{inverseColor}}">
      <div hidden$="[[!header]]" class="card-header">
        {{header}}
      </div>
      <template is="dom-if" if="[[image]]">
        <template is="dom-if" if="[[topPosition]]">
          <img class="card-img-top" hidden$="[[!image]]" src="{{image}}" alt="Card image cap">
        </template>
      </template>
      <template is="dom-if" if="[[hasContent]]">
        <div class$="[[overlays]]">
          <h4 class="card-title" hidden$="[[!title]]">{{title}}</h4>
          <h6 class="card-subtitle mb-2 text-muted" hidden$="[[!subtitle]]">{{subtitle}}</h6>
          <p class="card-text" hidden$="[[!text]]">{{text}}</p>
        </div>
      </template>
      <content></content>
      <template is="dom-if" if="[[image]]">
        <template is="dom-if" if="[[!topPosition]]">
          <img class="card-img-bottom"  hidden$="[[!image]]" src="{{image}}" alt="Card image cap">
        </template>
      </template>
    </div>
  </template>
  <script>
    Polymer({
      is: 'koa-card',
      properties: {
        overlays: {
          type: String,
          value: 'card-block'
        },
        color: {
          type: String,
          value: ''
        },
        inverse: {
          type: String,
          value:''
        },
        alignment: {
          type: String,
          value:''
        },
        topPosition: {
          type: Boolean,
          value: true
        },
        header: {
          type: String,
          value: ''
        },
        title: {
          type: String,
          value: ''
        },
        subtitle: {
          type: String,
          value: ''
        },
        text: {
          type: String,
          value: ''
        },
        hasContent: {
          type: Boolean,
          value: false
        }
      },
      ready: function() {

        if(Polymer.dom(this).node.getAttribute('img-position') !== null)
          this.topPosition = (Polymer.dom(this).node.getAttribute('img-position') === 'top')  ? true : false;

        if(Polymer.dom(this).node.getAttribute('header') !== null)
          this.header = Polymer.dom(this).node.getAttribute('header');

        if(Polymer.dom(this).node.getAttribute('title') !== null)
          this.title = Polymer.dom(this).node.getAttribute('title');

        if(Polymer.dom(this).node.getAttribute('subtitle') !== null)
          this.subtitle = Polymer.dom(this).node.getAttribute('subtitle');

        if(Polymer.dom(this).node.getAttribute('text') !== null)
          this.text = Polymer.dom(this).node.getAttribute('text');

        if(Polymer.dom(this).node.getAttribute('title') !== null ||
          Polymer.dom(this).node.getAttribute('subtitle') !== null ||
          Polymer.dom(this).node.getAttribute('text') !== null) {
            this.hasContent = true;
          }

        if(Polymer.dom(this).node.getAttribute('alignment') !== null) {
          switch (Polymer.dom(this).node.getAttribute('alignment')) {
            case 'left':
              this.alignment = '';
              break;
            case 'center':
              this.alignment = 'text-center';
              break;
            case 'right':
              this.alignment = 'text-right';
              break;
            default:
              this.alignment = '';
          }
        }

        if(Polymer.dom(this).node.getAttribute('inverse') !== null) {
          this.inverse = 'card-inverse';
          if(Polymer.dom(this).node.getAttribute('image') !== null) this.overlays = 'card-img-overlay';
        }

        if(Polymer.dom(this).node.getAttribute('color') !== null) {
          this.color = (Polymer.dom(this).node.getAttribute('color').indexOf('card-') > -1)
          ? Polymer.dom(this).node.getAttribute('color')
          : 'card-' + Polymer.dom(this).node.getAttribute('color');
        }

        if(Polymer.dom(this).node.getAttribute('color') !== null
          && Polymer.dom(this).node.getAttribute('inverse') !== null)
          this.inverseColor = 'inverse-color';
      }
    });
  </script>
</dom-module>
